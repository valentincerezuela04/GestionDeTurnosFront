<form
  [formGroup]="form"
  (ngSubmit)="submit()"
  class="sala-form"
  novalidate
>
  <h2>Crear sala</h2>

  <!-- Número -->
  @let numeroCtrl = form.get('numero');
  <div class="field">
    <label for="numero">Número</label>
    <input
      id="numero"
      type="number"
      formControlName="numero"
      [class.invalid]="numeroCtrl?.touched && numeroCtrl?.invalid"
    />

    @if (numeroCtrl?.touched && numeroCtrl?.hasError('required')) {
      <p class="error">El número es obligatorio.</p>
    }

    @if (numeroCtrl?.touched && numeroCtrl?.hasError('min')) {
      <p class="error">El número debe ser mayor o igual a 1.</p>
    }

        @if (numeroOcupado) {
      <p class="error">Ya existe una sala con ese número.</p>
    }
  </div>

  <!-- Descripción -->
  @let descCtrl = form.get('descripcion');
  <div class="field">
    <label for="descripcion">Descripción</label>
    <input
      id="descripcion"
      type="text"
      formControlName="descripcion"
      [class.invalid]="descCtrl?.touched && descCtrl?.invalid"
    />

    @if (descCtrl?.touched && descCtrl?.hasError('required')) {
      <p class="error">La descripción es obligatoria.</p>
    }

    @if (descCtrl?.touched && descCtrl?.hasError('minlength')) {
      <p class="error">
        La descripción debe tener al menos
        {{ descCtrl?.errors?.['minlength']?.requiredLength }} caracteres.
        (actual:
        {{ descCtrl?.errors?.['minlength']?.actualLength || 0 }})
      </p>
    }
  </div>


 <!-- Tamaño de sala -->
  @let sizeCtrl = form.get('salaSize');
  <div class="field">
    <label for="salaSize">Tamaño</label>
    <select
      id="salaSize"
      formControlName="salaSize"
      [class.invalid]="sizeCtrl?.touched && sizeCtrl?.invalid"
    >
      <option value="" disabled>Seleccione un tamaño</option>

      @for (size of ['PEQUEÑA', 'MEDIANA', 'GRANDE']; track size) {
        <option [ngValue]="size">
          {{ size }}
        </option>
      }
    </select>

    @if (sizeCtrl?.touched && sizeCtrl?.hasError('required')) {
      <p class="error">El tamaño es obligatorio.</p>
    }
  </div>

  <!-- Capacidad fija (solo lectura, derivada del tamaño) -->
  <div class="field">
    <label for="capacidad">Cantidad de personas</label>
    <input
      id="capacidad"
      type="number"
      [value]="capacidadSeleccionada ?? ''"
      readonly
    />

    @if (!capacidadSeleccionada) {
      <p class="hint">Seleccioná un tamaño para ver la capacidad.</p>
    }

    @if (capacidadSeleccionada) {
      <p class="hint">Capacidad fija según el tamaño seleccionado.</p>
    }
  </div>
  <button type="submit" [disabled]="form.invalid">
    Guardar
  </button>
</form>
